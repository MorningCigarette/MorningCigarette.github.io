<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="C#12 ä¸­çš„é›†åˆè¡¨è¾¾å¼ ç»å…¸é›†åˆåˆå§‹åŒ–å™¨ è‡ª C# 3.0 èµ·ï¼Œæˆ‘ä»¬å°±æœ‰äº† â€œé›†åˆåˆå§‹åŒ–å™¨â€ ã€‚å®ƒä»¬é‡‡ç”¨ {} æ¨¡å¼æ¥åˆå§‹åŒ–ä»»ä½•å®ç°äº† Add() æ–¹æ³•çš„ IEnumerable å®ç°ã€‚ä¾‹å¦‚ï¼Œè¿™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ List<string> å¹¶ç”¨ 5 ä¸ªå€¼åˆå§‹åŒ–å®ƒï¼š\n"><title>C#12 ä¸­çš„é›†åˆè¡¨è¾¾å¼</title><link rel=canonical href=https://MorningCigarette.github.io/p/collection-expressions/><link rel=stylesheet href=/scss/style.min.6a692fd055deae459f2a9767f57f3855ba80cafd5041317f24f7360f6ca47cdf.css><meta property='og:title' content="C#12 ä¸­çš„é›†åˆè¡¨è¾¾å¼"><meta property='og:description' content="C#12 ä¸­çš„é›†åˆè¡¨è¾¾å¼ ç»å…¸é›†åˆåˆå§‹åŒ–å™¨ è‡ª C# 3.0 èµ·ï¼Œæˆ‘ä»¬å°±æœ‰äº† â€œé›†åˆåˆå§‹åŒ–å™¨â€ ã€‚å®ƒä»¬é‡‡ç”¨ {} æ¨¡å¼æ¥åˆå§‹åŒ–ä»»ä½•å®ç°äº† Add() æ–¹æ³•çš„ IEnumerable å®ç°ã€‚ä¾‹å¦‚ï¼Œè¿™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ List<string> å¹¶ç”¨ 5 ä¸ªå€¼åˆå§‹åŒ–å®ƒï¼š\n"><meta property='og:url' content='https://MorningCigarette.github.io/p/collection-expressions/'><meta property='og:site_name' content='Sutra Library'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:published_time' content='2024-11-14T00:00:00+00:00'><meta property='article:modified_time' content='2024-11-14T00:00:00+00:00'><meta name=twitter:title content="C#12 ä¸­çš„é›†åˆè¡¨è¾¾å¼"><meta name=twitter:description content="C#12 ä¸­çš„é›†åˆè¡¨è¾¾å¼ ç»å…¸é›†åˆåˆå§‹åŒ–å™¨ è‡ª C# 3.0 èµ·ï¼Œæˆ‘ä»¬å°±æœ‰äº† â€œé›†åˆåˆå§‹åŒ–å™¨â€ ã€‚å®ƒä»¬é‡‡ç”¨ {} æ¨¡å¼æ¥åˆå§‹åŒ–ä»»ä½•å®ç°äº† Add() æ–¹æ³•çš„ IEnumerable å®ç°ã€‚ä¾‹å¦‚ï¼Œè¿™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ List<string> å¹¶ç”¨ 5 ä¸ªå€¼åˆå§‹åŒ–å®ƒï¼š\n"><link rel="shortcut icon" href=/favicon.png></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_5ab8cc3a8e310b0d.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>ğŸ¥</span></figure><div class=site-meta><h1 class=site-name><a href=/>Sutra Library</a></h1><h2 class=site-description>Love is the one thing weâ€™re capable of perceiving that transcends time and space.</h2></div></header><ol class=menu-social><li><a href=https://github.com/MorningCigarette target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com target=_blank title=Twitter rel=me><svg class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>Home</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>Archives</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>Search</span></a></li><li><a href=/about/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>about</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>æš—è‰²æ¨¡å¼</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">ç›®å½•</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#ç»å…¸é›†åˆåˆå§‹åŒ–å™¨>ç»å…¸é›†åˆåˆå§‹åŒ–å™¨</a></li><li><a href=#ä½¿ç”¨é›†åˆè¡¨è¾¾å¼ç»Ÿä¸€è¯­æ³•>ä½¿ç”¨é›†åˆè¡¨è¾¾å¼ç»Ÿä¸€è¯­æ³•</a></li><li><a href=#æ¨æ–­æ¥å£ç±»å‹>æ¨æ–­æ¥å£ç±»å‹</a></li><li><a href=#é’ˆå¯¹-readonlyspan-çš„é«˜æ•ˆè‡ªåŠ¨-stackalloc>é’ˆå¯¹ <code>ReadOnlySpan</code> çš„é«˜æ•ˆè‡ªåŠ¨ <code>stackalloc</code></a></li><li><a href=#é›†åˆè¡¨è¾¾å¼ä½¿é‡æ„æ›´ç®€å•>é›†åˆè¡¨è¾¾å¼ä½¿é‡æ„æ›´ç®€å•</a></li><li><a href=#ç©ºé›†åˆ>ç©ºé›†åˆ</a></li><li><a href=#ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦spread-elementä»å…¶ä»–é›†åˆæ„å»ºé›†åˆ>ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦ï¼ˆspread elementï¼‰ä»å…¶ä»–é›†åˆæ„å»ºé›†åˆ</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/c%23/>C#</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/collection-expressions/>C#12 ä¸­çš„é›†åˆè¡¨è¾¾å¼</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>Nov 14, 2024</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>é˜…è¯»æ—¶é•¿: 8 åˆ†é’Ÿ</time></div></footer></div></header><section class=article-content><h1 id=c12-ä¸­çš„é›†åˆè¡¨è¾¾å¼>C#12 ä¸­çš„é›†åˆè¡¨è¾¾å¼</h1><h2 id=ç»å…¸é›†åˆåˆå§‹åŒ–å™¨>ç»å…¸é›†åˆåˆå§‹åŒ–å™¨</h2><p>è‡ª <code>C# 3.0</code> èµ·ï¼Œæˆ‘ä»¬å°±æœ‰äº† â€œé›†åˆåˆå§‹åŒ–å™¨â€ ã€‚å®ƒä»¬é‡‡ç”¨ <code>{}</code> æ¨¡å¼æ¥åˆå§‹åŒ–ä»»ä½•å®ç°äº† <code>Add()</code> æ–¹æ³•çš„ <code>IEnumerable</code> å®ç°ã€‚ä¾‹å¦‚ï¼Œè¿™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ <code>List&lt;string></code> å¹¶ç”¨ 5 ä¸ªå€¼åˆå§‹åŒ–å®ƒï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>var</span> <span class=n>values</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>&gt;</span> <span class=p>{</span> <span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;2&#34;</span><span class=p>,</span> <span class=s>&#34;3&#34;</span><span class=p>,</span> <span class=s>&#34;4&#34;</span><span class=p>,</span> <span class=s>&#34;5&#34;</span> <span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>å¹•åï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„ä»£ç çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>List</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>&gt;</span> <span class=n>values</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>values</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>&#34;1&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>values</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>&#34;2&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>values</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>&#34;3&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>values</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>&#34;4&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>values</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=s>&#34;5&#34;</span><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><p><code>C#</code> ä¸­çš„æ•°ç»„åˆå§‹åŒ–æœ‰å…¶ç‰¹åˆ«ä¹‹å¤„ï¼Œä½ å¯ä»¥ç”¨æ¯”å…¶ä»–é›†åˆæ›´å¤šçš„æ–¹æ³•æ¥åˆå§‹åŒ–å®ƒä»¬ï¼Œå°½ç®¡çœ‹èµ·æ¥ä¸æ ‡å‡†é›†åˆåˆå§‹åŒ–å™¨ç›¸ä¼¼ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>var</span> <span class=n>values1</span> <span class=p>=</span> <span class=k>new</span><span class=p>[]</span> <span class=p>{</span> <span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;2&#34;</span><span class=p>,</span> <span class=s>&#34;3&#34;</span><span class=p>,</span> <span class=s>&#34;4&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>values2</span> <span class=p>=</span> <span class=k>new</span> <span class=kt>string</span><span class=p>[</span><span class=m>4</span><span class=p>]</span> <span class=p>{</span> <span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;2&#34;</span><span class=p>,</span> <span class=s>&#34;3&#34;</span><span class=p>,</span> <span class=s>&#34;4&#34;</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=kt>string</span><span class=p>[]</span> <span class=n>values3</span> <span class=p>=</span> <span class=p>{</span> <span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;2&#34;</span><span class=p>,</span> <span class=s>&#34;3&#34;</span><span class=p>,</span> <span class=s>&#34;4&#34;</span> <span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™äº›å·¥ä½œæ–¹å¼ä¸é›†åˆåˆå§‹åŒ–å™¨ä¸åŒï¼›è¿™é‡Œæ²¡æœ‰è°ƒç”¨ <code>Add()</code> æ–¹æ³•ã€‚ç›¸åï¼Œç¼–è¯‘å™¨ç”Ÿæˆçš„æ˜¯å¦‚æœä½ æ‰‹åŠ¨åšè¿™ä¸€åˆ‡æ—¶åŒæ ·çš„åˆå§‹åŒ–ä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>string</span><span class=p>[]</span> <span class=n>array</span> <span class=p>=</span> <span class=k>new</span> <span class=kt>string</span><span class=p>[</span><span class=m>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>array</span><span class=p>[</span><span class=m>0</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;1&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>array</span><span class=p>[</span><span class=m>1</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;2&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>array</span><span class=p>[</span><span class=m>2</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;3&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=n>array</span><span class=p>[</span><span class=m>3</span><span class=p>]</span> <span class=p>=</span> <span class=s>&#34;4&#34;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><p>æˆ‘ä»¬å·²ç»è®¨è®ºäº†é€šç”¨é›†åˆï¼ˆå¦‚ <code>List</code> ï¼‰å’Œæ•°ç»„çš„é›†åˆåˆå§‹åŒ–å™¨ï¼Œè¿˜æœ‰åœ¨ <code>Span</code> ä¸–ç•Œä¸­å˜å¾—æ›´ä¸ºæœ‰ç”¨çš„ <code>stackalloc</code> è¡¨è¾¾å¼ï¼Œå› ä¸ºä¸éœ€è¦ä½¿ç”¨ <code>unsafe</code> ä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>Span</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>array</span> <span class=p>=</span> <span class=k>stackalloc</span> <span class=p>[]{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>å¹•åï¼Œç¼–è¯‘å™¨å°†è¿™ä¸ª <code>stackalloc</code> åˆå§‹åŒ–å™¨è½¬åŒ–ä¸ºä¸€äº›ç±»ä¼¼è¿™æ ·çš„ <code>unsafe</code> ä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kd>unsafe</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>byte</span><span class=p>*</span> <span class=n>num</span> <span class=p>=</span> <span class=k>stackalloc</span> <span class=kt>byte</span><span class=p>[</span><span class=m>16</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>*(</span><span class=kt>int</span><span class=p>*)</span><span class=n>num</span> <span class=p>=</span> <span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>*(</span><span class=kt>int</span><span class=p>*)(</span><span class=n>num</span> <span class=p>+</span> <span class=m>4</span><span class=p>)</span> <span class=p>=</span> <span class=m>2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>*(</span><span class=kt>int</span><span class=p>*)(</span><span class=n>num</span> <span class=p>+</span> <span class=p>(</span><span class=n>nint</span><span class=p>)</span><span class=m>2</span> <span class=p>*</span> <span class=p>(</span><span class=n>nint</span><span class=p>)</span><span class=m>4</span><span class=p>)</span> <span class=p>=</span> <span class=m>3</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>*(</span><span class=kt>int</span><span class=p>*)(</span><span class=n>num</span> <span class=p>+</span> <span class=p>(</span><span class=n>nint</span><span class=p>)</span><span class=m>3</span> <span class=p>*</span> <span class=p>(</span><span class=n>nint</span><span class=p>)</span><span class=m>4</span><span class=p>)</span> <span class=p>=</span> <span class=m>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Span</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>array</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Span</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;(</span><span class=n>num</span><span class=p>,</span> <span class=m>4</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™æ®µä»£ç åœ¨æ ˆä¸Šåˆ›å»ºäº†ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åé€šè¿‡æŒ‡é’ˆè¿ç®—éå†æ¯ä¸ªå…ƒç´ ï¼Œè®¾ç½®æ¯ä¸ªå€¼ã€‚</p><h2 id=ä½¿ç”¨é›†åˆè¡¨è¾¾å¼ç»Ÿä¸€è¯­æ³•>ä½¿ç”¨é›†åˆè¡¨è¾¾å¼ç»Ÿä¸€è¯­æ³•</h2><p>æˆ‘ä»¬å·²ç»çœ‹åˆ°è‡³å°‘æœ‰ä¸‰ç§ä¸åŒçš„åœºæ™¯ä¸‹æˆ‘ä»¬åœ¨åˆå§‹åŒ–é›†åˆï¼š</p><ul><li>æ•°ç»„</li><li>ç±»ä¼¼ <code>List</code> çš„é›†åˆ</li><li>ä½¿ç”¨ <code>stackalloc</code> çš„ <code>ReadOnlySpan</code></li></ul><p>æ¯ç§æƒ…å†µéƒ½éœ€è¦ç¨å¾®ä¸åŒçš„è¯­æ³•ï¼Œä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>array</span> <span class=p>=</span> <span class=k>new</span><span class=p>[]</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>list</span> <span class=p>=</span> <span class=k>new</span><span class=p>()</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>HashSet</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>hashset</span> <span class=p>=</span> <span class=k>new</span><span class=p>()</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>span</span> <span class=p>=</span> <span class=k>stackalloc</span> <span class=p>[]</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™æœ‰ç‚¹æ··ä¹±å’Œçƒ¦äººã€‚<code>C#12</code> ä¸­å¼•å…¥çš„<strong>é›†åˆè¡¨è¾¾å¼</strong>æä¾›äº†ä¸€ç§ç®€åŒ–ã€ç»Ÿä¸€çš„è¯­æ³•ï¼Œé€‚ç”¨äºæ‰€æœ‰è¿™äº›ä¸åŒçš„é›†åˆç±»å‹ã€‚ä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>array</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>list</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>HashSet</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>hashset</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>span</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span></code></pre></td></tr></table></div></div><p>é›†åˆè¡¨è¾¾å¼åœ¨æ‰€æœ‰é›†åˆç±»å‹ä¸Šçš„ä¸€è‡´æ€§æ˜¯ä¸€ä¸ªçœŸæ­£çš„ä¼˜åŠ¿ï¼Œä½†è¿™å¹¶ä¸æ˜¯å”¯ä¸€çš„ä¼˜ç‚¹ã€‚é›†åˆè¡¨è¾¾å¼ç›¸æ¯”é›†åˆåˆå§‹åŒ–å™¨å¯ä»¥æä¾›æ€§èƒ½ä¼˜åŠ¿ï¼ˆæˆ‘ä»¬å°†åœ¨åç»­æ–‡ç« ä¸­æ¢è®¨ï¼‰ï¼Œä»¥åŠé¢å¤–çš„åŠŸèƒ½ã€‚</p><h2 id=æ¨æ–­æ¥å£ç±»å‹>æ¨æ–­æ¥å£ç±»å‹</h2><p>æƒ³è±¡ä¸€ä¸‹ï¼Œä½ æƒ³è¦åˆ›å»ºä¸€ä¸ªé›†åˆï¼Œä½†ä½ åªå…³å¿ƒå®ƒå®ç°äº† <code>IEnumerable</code> ã€‚ä½ éœ€è¦è‡ªå·±å†³å®šä½¿ç”¨å“ªä¸ªåç«¯ç±»å‹ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>list1</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>list2</span> <span class=p>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>list3</span> <span class=p>=</span> <span class=k>new</span> <span class=kt>int</span><span class=p>[]</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>é‚£ä¹ˆåº”è¯¥é€‰æ‹©å“ªä¸€ä¸ªå‘¢ï¼Ÿå¦‚æœæ‰€æœ‰ä½ éœ€è¦åšçš„å°±æ˜¯æšä¸¾åˆ—è¡¨ï¼Œé‚£ç†è®ºä¸Šé€‰æ‹©å“ªç§ç±»å‹éƒ½ä¸åº”è¯¥é‡è¦ï¼Œå¯¹å§ï¼Ÿé‚£ä¹ˆæ­£ç¡®çš„é€‰é¡¹æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>ä½¿ç”¨é›†åˆè¡¨è¾¾å¼ï¼Œä½ å¯ä»¥å°†æ­¤å†³ç­–å§”æ‰˜ç»™ç¼–è¯‘å™¨ã€‚ä½ å¯ä»¥ä¸æŒ‡å®šåç«¯ç±»å‹ï¼Œè€Œç”±ç¼–è¯‘å™¨æ¥å†³å®šã€‚è€Œä¸”ï¼Œé›†åˆè¡¨è¾¾å¼çš„é¢å¤–ä¼˜ç‚¹æ˜¯æ›´åŠ ç®€æ´ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>ienumerable</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>IList</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>ilist</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>IReadOnlyCollection</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>icollection</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span></code></pre></td></tr></table></div></div><p>å¹•åï¼Œç¼–è¯‘å™¨å®Œå…¨é€æ˜åœ°åˆ›å»ºäº†ä¸€ä¸ªå®ç°æ‰€éœ€æ¥å£çš„é›†åˆï¼Œæ‰€ä»¥ä½ æ— éœ€è€ƒè™‘è¿™ä¸€ç‚¹ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ç¼–è¯‘å™¨ä¼šè‡ªåŠ¨ä¸ºæ¥å£é›†åˆé€‰æ‹©ä¸€ä¸ªå…·ä½“çš„ç±»å‹ï¼Œä½†ä½ éœ€è¦æŒ‡å®š<em>æŸç§</em>ç±»å‹ã€‚ä¾‹å¦‚ï¼Œä½ ä¸èƒ½ä½¿ç”¨ <code>var</code> ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>var</span> <span class=n>values</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span> <span class=c1>// âŒ ç¼–è¯‘é”™è¯¯ï¼ŒCS9176ï¼šé›†åˆè¡¨è¾¾å¼æ²¡æœ‰ç›®æ ‡ç±»å‹</span>
</span></span><span class=line><span class=cl><span class=n>Sum</span><span class=p>(</span><span class=n>values</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=n>Sum</span><span class=p>([</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>]);</span> <span class=c1>// âœ… è¿™æ˜¯å¯è¡Œçš„</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>Sum</span><span class=p>(</span><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>v</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=n>v</span><span class=p>.</span><span class=n>Sum</span><span class=p>();</span>
</span></span></code></pre></td></tr></table></div></div><p>é—®é¢˜åœ¨äºï¼Œæ ¹æ® C#ç¼–è¯‘å™¨çš„å·¥ä½œæ–¹å¼ï¼Œå®ƒæ— æ³•æ¨æ–­ <code>values</code> çš„ç±»å‹åº”ä¸º <code>IEnumerable&lt;int></code> ï¼Œå› æ­¤æŠ›å‡ºäº†é”™è¯¯ã€‚æœªæ¥ç‰ˆæœ¬çš„ C#å¯èƒ½ä¼šæ”¹å˜è¿™ç§æƒ…å†µï¼Œä½†å¯èƒ½çš„è§£å†³æ–¹æ¡ˆæ˜¯å§‹ç»ˆé€‰æ‹© <code>int[]</code> ï¼Œè¿™å¹¶ä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„ï¼Œæ‰€ä»¥ä¸è¦æŠ±å¤ªå¤§å¸Œæœ›ã€‚</p><h2 id=é’ˆå¯¹-readonlyspan-çš„é«˜æ•ˆè‡ªåŠ¨-stackalloc>é’ˆå¯¹ <code>ReadOnlySpan</code> çš„é«˜æ•ˆè‡ªåŠ¨ <code>stackalloc</code></h2><p>å¯¹äº <code>ReadOnlySpan</code> å’Œ <code>Span</code> å®ä¾‹æ¥è¯´ï¼Œå¦‚æœä½ åªä½¿ç”¨é›†åˆåˆå§‹åŒ–å™¨ï¼Œæƒ…å†µä¹Ÿç±»ä¼¼ã€‚å¦‚æœä½ åªéœ€è¦åœ¨ <code>Span</code> æˆ– <code>ReadOnlySpan</code> ä¸­å­˜å‚¨ä¸€äº›æ•°æ®ï¼Œé‚£ä¹ˆä½¿ç”¨é›†åˆåˆå§‹åŒ–å™¨å°±éœ€è¦å†³å®šå°†æ•°æ®æ”¾åœ¨å“ªé‡Œï¼Œç„¶åå†ä»ä¸­è·å– <code>Span</code>ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>Span</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>spans2</span> <span class=p>=</span> <span class=k>stackalloc</span><span class=p>[]</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span> <span class=c1>// æ ˆä¸Šåˆ†é…æ•°ç»„</span>
</span></span><span class=line><span class=cl><span class=n>Span</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>spans3</span> <span class=p>=</span> <span class=k>new</span><span class=p>[]</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>};</span> <span class=c1>// åœ¨å †ä¸Šåˆ†é…</span>
</span></span><span class=line><span class=cl><span class=n>Span</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>&gt;</span> <span class=n>spans4</span> <span class=p>=</span> <span class=k>new</span><span class=p>[]</span> <span class=p>{</span> <span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;2&#34;</span><span class=p>,</span> <span class=s>&#34;3&#34;</span><span class=p>,</span> <span class=s>&#34;4&#34;</span> <span class=p>};</span> <span class=c1>// ä¸èƒ½ç›´æ¥ä½¿ç”¨ stackalloc åˆ†é…å­—ç¬¦ä¸²æ•°ç»„</span>
</span></span></code></pre></td></tr></table></div></div><p>è™½ç„¶è¿™ä¸æ˜¯ä¸€ä¸ªå¾ˆå¤§çš„å†³ç­–ï¼Œé€šå¸¸åªæœ‰ä¸¤ä¸ªåˆç†çš„é€‰æ‹©ï¼Œä½†è¿˜æ˜¯éœ€è¦é¢å¤–è€ƒè™‘çš„äº‹æƒ…ã€‚æ­¤å¤–ï¼Œä½ ä¸èƒ½ç›´æ¥ä½¿ç”¨ <code>stackalloc</code> ä¸º <code>string[]</code> åˆ†é…å†…å­˜ï¼Œé™¤éé€šè¿‡ä¸€äº› <code>InlineArray</code> çš„æŠ€å·§ ã€‚</p><p>ä½¿ç”¨é›†åˆè¡¨è¾¾å¼ï¼Œä½ å¯ä»¥å†æ¬¡å°†æ­¤å†³ç­–å§”æ‰˜ç»™ç¼–è¯‘å™¨ï¼Œå®ƒä¼šåšå‡ºæ­£ç¡®çš„å¤„ç†ã€‚</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>readonlyspans</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>Span</span><span class=p>&lt;</span><span class=kt>string</span><span class=p>&gt;</span> <span class=n>spans</span> <span class=p>=</span> <span class=p>[</span><span class=s>&#34;1&#34;</span><span class=p>,</span> <span class=s>&#34;2&#34;</span><span class=p>,</span> <span class=s>&#34;3&#34;</span><span class=p>,</span> <span class=s>&#34;4&#34;</span><span class=p>];</span>
</span></span></code></pre></td></tr></table></div></div><p>åœ¨ç³»åˆ—çš„åç»­éƒ¨åˆ†ï¼Œä½ ä¼šå‘ç°è¿™äº›ç‰¹å®šçš„é›†åˆè¡¨è¾¾å¼æ¡ˆä¾‹è¢«<strong>é«˜åº¦ä¼˜åŒ–</strong>ï¼</p><h2 id=é›†åˆè¡¨è¾¾å¼ä½¿é‡æ„æ›´ç®€å•>é›†åˆè¡¨è¾¾å¼ä½¿é‡æ„æ›´ç®€å•</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘å±•ç¤ºçš„æ‰€æœ‰ä¾‹å­éƒ½æ˜¯å°†é›†åˆè¡¨è¾¾å¼èµ‹å€¼ç»™å˜é‡ï¼Œä½†å®é™…ä¸Šä½ ä¹Ÿå¯ä»¥ç›´æ¥å°†é›†åˆè¡¨è¾¾å¼ä½œä¸ºæ–¹æ³•å‚æ•°ä½¿ç”¨ï¼Œæ¯”å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Linq</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=nn>System.Collections.Generic</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// åˆ›å»ºä¸€ä¸ªæ¥å—IEnumerable&lt;int&gt;çš„æ–¹æ³•</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>Sum</span><span class=p>(</span><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>values</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=n>values</span><span class=p>.</span><span class=n>Sum</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ä½¿ç”¨é›†åˆè¡¨è¾¾å¼è°ƒç”¨æ–¹æ³•</span>
</span></span><span class=line><span class=cl><span class=n>Sum</span><span class=p>([</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>]);</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™ç§æ¨¡å¼çš„ä¸€ä¸ªå¥½å¤„æ˜¯ï¼Œå¦‚æœæˆ‘æ”¹å˜äº† <code>Sum()</code> çš„ç­¾åï¼Œæˆ‘ä¸éœ€è¦æ”¹å˜è°ƒç”¨ç«™ç‚¹ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœä½ ä½¿ç”¨é›†åˆåˆå§‹åŒ–å™¨ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=c1>// å¦‚æœæ–¹æ³•æ¥å—æ•°ç»„...</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>Sum1</span><span class=p>(</span><span class=kt>int</span><span class=p>[]</span> <span class=n>values</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=n>values</span><span class=p>.</span><span class=n>Sum</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=n>Sum1</span><span class=p>(</span><span class=k>new</span> <span class=p>[]</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>});</span> <span class=c1>// å¿…é¡»ä½¿ç”¨æ•°ç»„è¯­æ³•</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// å¦‚æœæ–¹æ³•æ¥å—IEnumerable...</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>Sum2</span><span class=p>(</span><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>values</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=n>values</span><span class=p>.</span><span class=n>Sum</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=n>Sum2</span><span class=p>(</span><span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=p>{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>});</span> <span class=c1>// å¿…é¡»ä½¿ç”¨æ˜¾å¼ç±»å‹ï¼Œå¦‚Listæˆ–ç±»ä¼¼</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// å¦‚æœæ–¹æ³•æ¥å—ReadOnlySpan...</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>Sum3</span><span class=p>(</span><span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>values</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>total</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span> <span class=p>(</span><span class=kt>var</span> <span class=k>value</span> <span class=k>in</span> <span class=n>values</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>total</span> <span class=p>+=</span> <span class=k>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>total</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=n>Sum3</span><span class=p>(</span><span class=k>new</span> <span class=p>[]{</span> <span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span> <span class=p>});</span> <span class=c1>// å¿…é¡»é€‰æ‹©æ ‡å‡†æ•°ç»„æˆ–è€…ä½¿ç”¨stackallocåˆ†é…çš„æ•°ç»„</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚æœä½¿ç”¨é›†åˆè¡¨è¾¾å¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®Œå…¨ç›¸åŒçš„è¯­æ³•æ¥è°ƒç”¨æ‰€æœ‰ä¸‰ä¸ª <code>Sum()</code> å®ç°ï¼š</p><p><code>Sum1([ 1, 2, 3, 4 ]); Sum2([ 1, 2, 3, 4 ]); Sum3([ 1, 2, 3, 4 ]);</code></p><p>å¹¶ä¸”ï¼Œç¼–è¯‘å™¨ä¼šä½¿ç”¨æœ€æœ‰æ•ˆçš„å®ç°æ–¹å¼æ¥åˆ›å»ºæ‰€éœ€ç±»å‹çš„é›†åˆã€‚</p><p>è¿™çœ‹èµ·æ¥å¯èƒ½æ˜¯ä¸€ä»¶å°äº‹ï¼Œè€Œä¸”åœ¨æŸç§ç¨‹åº¦ä¸Šç¡®å®æ˜¯è¿™æ ·ï¼Œä½†æ­£æ˜¯æ‰€æœ‰è¿™äº›å°å°çš„ä¾¿åˆ©ç‰¹æ€§ä½¿å¾—é›†åˆè¡¨è¾¾å¼æˆä¸ºä¸€ä¸ªéå¸¸æ•´æ´çš„åŠŸèƒ½ï¼æ•´ä½“è€Œè¨€ï¼Œæ­£æ˜¯è¿™äº›å¾®å°çš„æ–¹ä¾¿æ€§è®©é›†åˆè¡¨è¾¾å¼çš„ä½¿ç”¨å˜å¾—æä¸ºé¡ºæ‰‹å’Œé«˜æ•ˆã€‚</p><h2 id=ç©ºé›†åˆ>ç©ºé›†åˆ</h2><p>åœ¨ <code>C#</code> ä¸­ï¼Œé›†åˆè¡¨è¾¾å¼çš„ä¸€ä¸ªç‰¹æ€§æ˜¯ç¼–è¯‘å™¨æ˜ç¡®è¯†åˆ«ç©ºé›†åˆçš„è¯­æ³•ã€‚è¿™æ„å‘³ç€ä½ ä¸å†éœ€è¦å†™åƒä¸‹é¢è¿™æ ·çš„ä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>var</span> <span class=n>empty</span> <span class=p>=</span> <span class=k>new</span> <span class=kt>int</span><span class=p>[]{};</span> <span class=c1>// é€šå¸¸ä½ ä¸åº”è¯¥è¿™æ ·åš...</span>
</span></span><span class=line><span class=cl><span class=kt>var</span> <span class=n>empty</span> <span class=p>=</span> <span class=n>Array</span><span class=p>.</span><span class=n>Empty</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;();</span> <span class=c1>// ...ç›¸åï¼Œæ›´å€¾å‘äºä½¿ç”¨è¿™è¡Œä»£ç !</span>
</span></span></code></pre></td></tr></table></div></div><p>ç°åœ¨ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>[]</code> æ¥ç”Ÿæˆä¸€ä¸ªé€‚å½“çš„ç©ºé›†åˆç‰ˆæœ¬ï¼Œä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>empty</span> <span class=p>=</span> <span class=p>[];</span>
</span></span></code></pre></td></tr></table></div></div><p>é›†åˆè¡¨è¾¾å¼ç›¸æ¯”äºæ˜¾å¼åˆå§‹åŒ–æœ‰ä¸¤å¤§ä¸»è¦ä¼˜åŠ¿ï¼š</p><ul><li>ç¼–è¯‘å™¨å¯ä»¥é€‰æ‹©åˆ›å»ºç©ºé›†åˆçš„æœ€æœ‰æ•ˆæ–¹å¼ï¼Œæ¯”å¦‚é€‰æ‹© <code>Array.Empty()</code>ï¼ˆæˆ–å…¶ç­‰ä»·æ–¹æ³•ï¼‰ã€‚</li><li>å¯¹äºæ‰€æœ‰é›†åˆç±»å‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€è‡´çš„è¯­æ³•ã€‚</li></ul><p>ä»¥ä¸‹ç¤ºä¾‹å±•ç¤ºäº†å¤šç§é›†åˆç±»å‹ï¼Œä»¥åŠå¦‚ä½•ä½¿ç”¨ <code>[]</code> æ¥åˆ›å»ºå®ƒä»¬çš„ç©ºç‰ˆæœ¬ã€‚æ¯è¡Œä»£ç åçš„æ³¨é‡Šæ˜¾ç¤ºäº†ç¼–è¯‘å™¨ä¸ºç‰¹å®šç±»å‹ç”Ÿæˆçš„ä»£ç ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>array</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// Array.Empty()</span>
</span></span><span class=line><span class=cl><span class=n>HashSet</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>hashset</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// new HashSet&lt;int&gt;()</span>
</span></span><span class=line><span class=cl><span class=n>List</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>list</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// new List&lt;int&gt;()</span>
</span></span><span class=line><span class=cl><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>ienumerable</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// Array.Empty()</span>
</span></span><span class=line><span class=cl><span class=n>ICollection</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>icollection</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// new List&lt;int&gt;()</span>
</span></span><span class=line><span class=cl><span class=n>IList</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>ilist</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// new List&lt;int&gt;()</span>
</span></span><span class=line><span class=cl><span class=n>IReadOnlyCollection</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>readonlycollection</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// Array.Empty()</span>
</span></span><span class=line><span class=cl><span class=n>IReadOnlyList</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>readonlyList</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// Array.Empty()</span>
</span></span><span class=line><span class=cl><span class=n>Span</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>span</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// default(Span&lt;int&gt;)</span>
</span></span><span class=line><span class=cl><span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>readonlyspan</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// default(ReadOnlySpan&lt;int&gt;)</span>
</span></span><span class=line><span class=cl><span class=n>ImmutableArray</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>immutablearray</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// ImmutableArray.CreateRange(Array.Empty())</span>
</span></span><span class=line><span class=cl><span class=n>ImmutableList</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>immutablelist</span> <span class=p>=</span> <span class=p>[];</span> <span class=c1>// ImmutableList.Create(default(ReadOnlySpan&lt;int&gt;));</span>
</span></span></code></pre></td></tr></table></div></div><p>å¦‚ä½ æ‰€è§ï¼Œç¼–è¯‘å™¨å°½å¯èƒ½åœ°é«˜æ•ˆï¼›å¦‚æœç±»å‹æ˜¯å¯å˜çš„ï¼Œå¦‚ <code>HashSet</code> æˆ– <code>List</code>ï¼Œé‚£ä¹ˆå®ƒåªèƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„å®ä¾‹ï¼›ä½†å¦‚æœå¯ä»¥ä½¿ç”¨ä¸åˆ†é…å†…å­˜çš„ç‰ˆæœ¬ï¼Œå¦‚ <code>Array.Empty()</code>ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šé‡‡ç”¨è¿™ç§æ–¹å¼ï¼è¯·æ³¨æ„ï¼Œåœ¨æœ€åä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œ<code>ImmutableArray</code> å’Œ <code>ImmutableList</code> ä½¿ç”¨äº†ä¸åŒçš„æ„é€ å‡½æ•°æ¥åˆ›å»ºç©ºé›†åˆï¼Œå› ä¸ºå®ƒä»¬æ˜¯ä¸å¯å˜é›†åˆã€‚</p><h2 id=ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦spread-elementä»å…¶ä»–é›†åˆæ„å»ºé›†åˆ>ä½¿ç”¨å±•å¼€è¿ç®—ç¬¦ï¼ˆspread elementï¼‰ä»å…¶ä»–é›†åˆæ„å»ºé›†åˆ</h2><p>æˆ‘ä»¬å·²ç»äº†è§£äº†é›†åˆè¡¨è¾¾å¼çš„ä¸¤ä¸ªå¥½å¤„ï¼š</p><ul><li>ä¸€è‡´çš„è¯­æ³•</li><li>é«˜æ•ˆçš„ç¼–è¯‘å™¨ç”Ÿæˆå®ç°</li></ul><p>é›†åˆè¡¨è¾¾å¼çš„å¦ä¸€ä¸ªé‡è¦ç‰¹æ€§æ˜¯ <em>å±•å¼€è¿ç®—ç¬¦</em> (<code>..</code>)ã€‚è¿™ä½¿ä½ èƒ½å¤Ÿæ›´å®¹æ˜“åœ°ä»å…¶ä»–é›†åˆå®ä¾‹æ„å»ºæ–°çš„é›†åˆã€‚</p><p>ä¸¾ä¸ªå…·ä½“çš„ä¾‹å­ï¼Œå‡è®¾ä½ æœ‰ä¸¤ä¸ª <code>IEnumerable</code> é›†åˆï¼Œå¹¶ä¸”ä½ æƒ³å°†å®ƒä»¬ä½œä¸ºæ•°ç»„è¿æ¥èµ·æ¥ã€‚ä½¿ç”¨ LINQï¼Œè¿™æ˜¯ç›¸å½“å®¹æ˜“åšåˆ°çš„ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸“é—¨ç”¨äºæ­¤ç±»æ“ä½œçš„æ‰©å±•æ–¹æ³•ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>ConcatAsArray</span><span class=p>(</span><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>first</span><span class=p>,</span> <span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>first</span><span class=p>.</span><span class=n>Concat</span><span class=p>(</span><span class=n>second</span><span class=p>).</span><span class=n>ToArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>å¾ˆå¥½ï¼Œä½†æ˜¯å¦‚æœç°åœ¨ä½ éœ€è¦å¤„ç†çš„æ˜¯ <code>ReadOnlySpan</code> è€Œä¸æ˜¯ <code>IEnumerable</code> å‘¢ï¼Ÿä¸å¹¸çš„æ˜¯ï¼Œæ­£å¦‚æˆ‘ä»¬ä¹‹å‰è®¨è®ºçš„é‚£æ ·ï¼Œ<code>ReadOnlySpan</code> ä¸å®ç° <code>IEnumerable</code> æ¥å£ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯èƒ½éœ€è¦è¿™æ ·åšï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>ConcatAsArray</span><span class=p>(</span><span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>first</span><span class=p>,</span> <span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>second</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>var</span> <span class=n>list</span> <span class=p>=</span> <span class=k>new</span> <span class=n>List</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;(</span><span class=n>first</span><span class=p>.</span><span class=n>Length</span> <span class=p>+</span> <span class=n>second</span><span class=p>.</span><span class=n>Length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=p>.</span><span class=n>AddRange</span><span class=p>(</span><span class=n>first</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>list</span><span class=p>.</span><span class=n>AddRange</span><span class=p>(</span><span class=n>second</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>list</span><span class=p>.</span><span class=n>ToArray</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™è™½ç„¶ä¸æ˜¯ <em>ç³Ÿç³•</em>ï¼Œä½†ä»ç„¶è®©äººæ„Ÿåˆ°æ¼ç«ï¼Œå› ä¸ºå¯¹äºæ¯ç§ä¸åŒçš„é›†åˆç±»å‹éƒ½å¾—è€ƒè™‘è¿™äº›ç»†èŠ‚ã€‚è€Œä½¿ç”¨é›†åˆè¡¨è¾¾å¼å’Œå±•å¼€è¿ç®—ç¬¦ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªç®€æ´çš„å¿«æ·æ–¹å¼ï¼Œå®ƒå¯ä»¥ç”¨äºæ‰€æœ‰å—æ”¯æŒçš„é›†åˆç±»å‹ã€‚ä¸Šè¿°ä¸¤ç§é‡è½½éƒ½å¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼å®ç°ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>ConcatAsArray</span><span class=p>(</span><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>first</span><span class=p>,</span> <span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>second</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>[..</span><span class=n>first</span><span class=p>,</span> <span class=p>..</span><span class=n>second</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>ConcatAsArray</span><span class=p>(</span><span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>first</span><span class=p>,</span> <span class=n>ReadOnlySpan</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>second</span><span class=p>)</span> <span class=p>=&gt;</span> <span class=p>[..</span><span class=n>first</span><span class=p>,</span> <span class=p>..</span><span class=n>second</span><span class=p>];</span>
</span></span></code></pre></td></tr></table></div></div><p>è€Œä¸”ï¼Œç”±äºé›†åˆè¡¨è¾¾å¼çš„ä¸€è‡´æ€§ï¼Œå¦‚æœä½ æ›´æ”¹ <code>ConcatAsArray()</code> æ–¹æ³•çš„å‚æ•° <em>æˆ–è€…</em> è¿”å›ç±»å‹ï¼Œä½ å®Œå…¨ä¸éœ€è¦ä¿®æ”¹é›†åˆè¡¨è¾¾å¼æœ¬èº«ï¼Œå®ƒä¾æ—§å¯ä»¥æ­£å¸¸å·¥ä½œï¼</p><p><code>..</code> è¿ç®—ç¬¦æ„å‘³ç€ â€œå†™å‡ºé›†åˆä¸­çš„æ‰€æœ‰å€¼â€ ï¼Œå› æ­¤å†ä¸¾ä¸€ä¸ªä¾‹å­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>array</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=n>IEnumerable</span><span class=p>&lt;</span><span class=kt>int</span><span class=p>&gt;</span> <span class=n>oddValues</span> <span class=p>=</span> <span class=n>array</span><span class=p>.</span><span class=n>Where</span><span class=p>(</span><span class=kt>int</span><span class=p>.</span><span class=n>IsOddInteger</span><span class=p>);</span> <span class=c1>// 1, 3</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>evenValues</span> <span class=p>=</span> <span class=p>[..</span><span class=n>array</span><span class=p>.</span><span class=n>Where</span><span class=p>(</span><span class=kt>int</span><span class=p>.</span><span class=n>IsEvenInteger</span><span class=p>)];</span>      <span class=c1>// 2, 4</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>allValues</span> <span class=p>=</span> <span class=p>[..</span><span class=n>oddValues</span><span class=p>,</span> <span class=p>..</span><span class=n>evenValues</span><span class=p>];</span>             <span class=c1>// 1, 3, 2, 4</span>
</span></span></code></pre></td></tr></table></div></div><p>ä¸Šè¿°ä»£ç å¤šæ¬¡ä½¿ç”¨äº†å±•å¼€è¿ç®—ç¬¦ï¼Œä½†åœ¨æ¯ç§æƒ…å†µä¸‹ï¼Œå®ƒéƒ½æ„å‘³ç€ â€œå†™å‡ºé›†åˆçš„æ‰€æœ‰å…ƒç´ â€ ã€‚æ‰€ä»¥åœ¨æœ€åä¸€æ­¥ä¸­ï¼Œ<code>allValues</code> åŒ…å«äº† <code>oddValues</code> ä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œåé¢è·Ÿç€ <code>evenValues</code> ä¸­çš„æ‰€æœ‰å€¼ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥åœ¨é›†åˆè¡¨è¾¾å¼ä¸­æ··åˆå•ä¸€å€¼å’Œå±•å¼€é›†åˆï¼Œä¾‹å¦‚ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>arr</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>myValues</span> <span class=p>=</span> <span class=p>[</span><span class=m>0</span><span class=p>,</span> <span class=p>..</span><span class=n>arr</span><span class=p>,</span> <span class=m>5</span><span class=p>,</span> <span class=m>6</span><span class=p>];</span> <span class=c1>// 0, 1, 2, 3, 4, 5, 6</span>
</span></span></code></pre></td></tr></table></div></div><p>æœ€ç»ˆç»“æœå°±åƒæ˜¯éå†äº† <code>arr</code> å¹¶æ·»åŠ äº†æ¯ä¸ªå€¼ä¸€æ ·ã€‚</p><p>æ³¨æ„ï¼Œå±•å¼€è¿ç®—ç¬¦ <code>..</code> ä¸ <em>èŒƒå›´è¿ç®—ç¬¦</em>ï¼ˆå¦‚ <code>1..3</code> æˆ– <code>2..^</code> ä¸­çš„ <code>..</code>ï¼‰æ˜¯ <em>ä¸åŒ</em> çš„ï¼Œåè€…ç”¨äºå¯¹æ•°ç»„è¿›è¡Œ <em>ç´¢å¼•</em>ã€‚ç„¶è€Œï¼Œä½ å¯ä»¥ç»“åˆä½¿ç”¨å®ƒä»¬ï¼Œå…ˆç”¨ <em>èŒƒå›´</em> æ¥é€‰æ‹©å…ƒç´ å­é›†ï¼Œç„¶åå°†å®ƒä»¬ <em>å±•å¼€</em> åˆ°é›†åˆè¡¨è¾¾å¼ä¸­ï¼š</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-csharp data-lang=csharp><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>primes</span> <span class=p>=</span> <span class=p>[</span><span class=m>1</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=m>3</span><span class=p>,</span> <span class=m>5</span><span class=p>,</span> <span class=m>7</span><span class=p>,</span> <span class=m>9</span><span class=p>,</span> <span class=m>11</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span><span class=p>[]</span> <span class=n>some</span> <span class=p>=</span> <span class=p>[</span><span class=m>0</span><span class=p>,</span> <span class=p>..</span><span class=n>primes</span><span class=p>[</span><span class=m>1.</span><span class=p>.^</span><span class=m>1</span><span class=p>]];</span> <span class=c1>// 0, 2, 3, 5, 7, 9</span>
</span></span></code></pre></td></tr></table></div></div><p>è¿™æ®µä»£ç ä½¿ç”¨ <code>1..^1</code> èŒƒå›´è¿ç®—ç¬¦å– <code>primes</code> æ•°ç»„çš„ç¬¬1ä¸ªè‡³N-1ä¸ªå…ƒç´ ï¼ˆå³ <code>2, 3, 5, 7, 9</code>ï¼‰ï¼Œç„¶ååœ¨é›†åˆè¡¨è¾¾å¼ä¸­ä½¿ç”¨å±•å¼€ <code>..</code>ã€‚</p><p>é›†åˆè¡¨è¾¾å¼ä¸ºåˆ›å»ºé›†åˆæ·»åŠ äº†ä¸€ç§å¾ˆå¥½çš„å¯¹ç§°æ€§ï¼ˆåœ¨é‡æ„ä»ä¸€ç§é›†åˆç±»å‹åˆ°å¦ä¸€ç§æ—¶ç‰¹åˆ«æœ‰ç”¨ï¼‰ï¼Œå¹¶ä¸”é€šè¿‡å±•å¼€è¿ç®—ç¬¦ä½¿é›†åˆçš„ç»„åˆå˜å¾—æ›´åŠ ç®€å•ã€‚ä½†é›†åˆè¡¨è¾¾å¼ä¸ä»…ä»…æ˜¯å…³äºè¯­æ³•ã€‚é‡è¦çš„æ˜¯ï¼Œé›†åˆè¡¨è¾¾å¼ä¸ºç¼–è¯‘å™¨æä¾›äº†ä¼˜åŒ–å…¶ç”Ÿæˆä»£ç çš„é€‰é¡¹ã€‚</p><p>åœ¨ä¸‹ä¸€ç¯‡ä¸­ï¼Œæˆ‘ä»¬å°†æ¢è®¨æ›´å¤šç±»å‹çš„é›†åˆï¼Œå¦‚ <code>T[]</code> å’Œ <code>ReadOnlySpan&lt;T></code>ï¼Œçœ‹çœ‹å®ƒä»¬åœ¨ä½¿ç”¨é›†åˆè¡¨è¾¾å¼æ—¶æ˜¯å¦‚ä½•è¢«é«˜åº¦ä¼˜åŒ–çš„ã€‚</p><p><a class=link href="https://www.koudingke.cn/go?link=https%3a%2f%2fandrewlock.net%2fbehind-the-scenes-of-collection-expressions-part-1-introducing-collection-expressions-in-csharp12%2f" target=_blank rel=noopener>è‹±æ–‡åŸæ–‡</a></p></section><footer class=article-footer><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous defer></script><script>window.addEventListener("DOMContentLoaded",()=>{renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}],ignoredClasses:["gist"]})})</script></article><aside class=related-content--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/jsonserilize/><div class=article-details><h2 class=article-title>é¿å…Newtonsoft.Jsonååºåˆ—åŒ–å‡ºç°é‡å¤åˆ—è¡¨é¡¹</h2></div></a></article><article><a href=/p/wpf_content_resource/><div class=article-details><h2 class=article-title>Wpfç”Ÿæˆæ“ä½œï¼šå†…å®¹å’Œèµ„æº</h2></div></a></article><article><a href=/p/c%23test/><div class=article-details><h2 class=article-title>C#é«˜é¢‘é¢è¯•é¢˜</h2></div></a></article><article><a href=/p/pyandcsharp/><div class=article-details><h2 class=article-title>Python çš„ self å’Œ C# çš„ this</h2></div></a></article><article><a href=/p/middleware/><div class=article-details><h2 class=article-title>C#.NET ä¸­é—´ä»¶è¯¦è§£</h2></div></a></article></div></div></aside><script src=https://giscus.app/client.js data-repo=MorningCigarette/MorningCigarette.github.io data-repo-id=R_kgDOMfZTRw data-category=Announcements data-category-id=DIC_kwDOMfZTR84ChaA8 data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=light data-lang=en crossorigin=anonymous async></script><script>function setGiscusTheme(e){let t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:{setConfig:{theme:e}}},"https://giscus.app")}(function(){addEventListener("message",t=>{if(event.origin!=="https://giscus.app")return;e()}),window.addEventListener("onColorSchemeChange",e);function e(){setGiscusTheme(document.documentElement.dataset.scheme==="light"?"light":"dark")}})()</script><footer class=site-footer><section class=copyright>&copy;
2020 -
2025 Sutra Library</section><section class=powerby>ä½¿ç”¨ <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> æ„å»º<br>ä¸»é¢˜ <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.27.0>Stack</a></b> ç”± <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> è®¾è®¡</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>